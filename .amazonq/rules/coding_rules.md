■コーディングルール 素案 
1. 基本方針 
- 誰が読んでも理解できるコードを書くことを最優先 
- エラーに強く、保守性・再利用性を意識 
- チーム内で統一された記法を用い、属人化を防ぐ 

2. 命名規則 
- Option Explicit をモジュールの先頭に記載 
- 変数名・関数名は 意味の分かる英語またはローマ字英語 を使用（x1, tmpは禁止） 
- 定数名は大文字＋アンダースコア（例：CONST MAX_COUNT As Long = 100） 
- 変数接頭辞（ハンガリアン記法の簡易版）： 
   str：文字列（例：strFileName） 
   int：整数 
   lng：Long 
   dbl：Double 
   dtm：日付 
   bln：真偽値 
   rng：Range 
   obj：オブジェクト 
   mod：モジュール 
   frm：フォーム 
   sht：シート 
   wb：ブック 
- プロシージャ名・関数名は動詞から始める（例：GetUserInfo、ExportData） 
- モジュールは用途別に分割し、接頭辞を付ける（例：modFileIO、modDBAccess） 
- フォーム・シート・ブックにも統一ルール（例：frmLogin, shtSales, wbMaster） 

3. コメント・ドキュメンテーション 
- 各プロシージャの冒頭に「概要・引数・戻り値」をコメントで記載 

'======================================== 
' 概要   : ユーザー情報を取得 
' 引数   : UserID As String 
' 戻り値 : ユーザー名 As String 
'======================================== 

- 複雑な処理には途中で処理意図をコメントする 
- コメントは日本語で簡潔に（社外配布時は英語可） 
- 変更時には「変更日・担当者・内容・変更したExcelファイル」をPowerAppsアプリに追記 

4. エラーハンドリング 
- 原則 すべてのプロシージャにエラーハンドリングを実装 
   On Error GoTo を用い、最後に Exit Sub/Function → ErrorHandler: を配置 
   エラー内容をユーザーに分かりやすく伝える（MsgBoxやログ出力） 
----------------------------------------------------------------------- 
Sub SampleProc() 
   On Error GoTo ErrHandler 
   '処理内容 
    
ExitProc: 
   Exit Sub 
ErrHandler: 
   MsgBox "エラー番号: " & Err.Number & vbCrLf & "内容: " & Err.Description 
   Resume ExitProc 
End Sub 
----------------------------------------------------------------------- 
- 想定されるエラーは事前に If 文でチェックして回避 

5. コーディング規約 
- インデントはTabを統一 
- 長い処理は関数に分割し、1関数は 20〜50行程度 を目安にする 
- マジックナンバー禁止 → 定数化する 
- 文字コードやファイルパスは環境依存しない書き方を意識（utf8で処理） 
- 繰り返し処理は For Each を優先（Rangeなどオブジェクト操作時） 
- 可読性を優先し、1行に複数処理を書かない 

6. 共通処理・ライブラリ化 
- 再利用性の高い処理（例：日付整形、ファイル操作）は共通モジュールに集約 
- Excel依存関数（Cells, Range操作）は極力共通関数にまとめる 

7. セキュリティ・運用 
- パスワードや認証情報はコードに直書きしない 
- 外部接続・ファイルパスは設定ファイルや定数にまとめる 
- 不要なコード・未使用変数は削除 

8. AIの利用方法 
- 社外秘データ、顧客情報、個人情報を直接AIに入力しない 
- AI出力のコードは必ず人間がレビューする 
- 動作確認＋ルール遵守チェックを行い、そのまま本番環境に流用しない